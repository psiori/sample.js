/*!
 * Sample.js - Sends tracking events to 5d's analytics service. v0.0.1
 * http://www.5dlab.com
 *
 * Copyright (c) 2014-2014, Sascha Lange, JoÃ£o Alves
 * Licensed under the MIT License.
 *
 */

!function(a){var b=function(){var a=[],b=!1,c=!1,d=null,f={start:function(){c||(c=!0,d=setTimeout(function(){f.sendNext()},1e3))},stop:function(){c&&(c=!1,clearTimeout(d))},isRunning:function(){return c===!0},length:function(){return a.length},isEmpty:function(){return 0===a.length},isSending:function(){return b===!0},add:function(b,c){a[a.length]={event:b,callback:c},this.sendNext()},sendNext:function(){if(c&&!b&&!this.isEmpty()){b=!0;var d=a[0],f=JSON.stringify({p:d.event}),g=this,h=new XMLHttpRequest;h.addEventListener("load",function(){a.shift(),b=!1,g.sendNext()},!0),h.addEventListener("error",function(){b=!1}),h.open("POST",e.getEndpoint()),h.setRequestHeader("Content-type","application/json; charset=utf-8"),h.setRequestHeader("Content-length",f.length),h.setRequestHeader("Connection","close"),h.send(f)}}};return f.start(),f}(),c="http://events.neurometry.com/sample/v01/event",d=null,e={safariOnly:!1,setEndpoint:function(a){c=a},getEndpoint:function(){return c},setAppToken:function(a){d=a},track:function(a,c){(this.safariOnly!==!0||this.isSafari())&&(c.event_name=a,c.app_token=d,b.add(c,function(){}))},isSafari:function(){var a=null;return function(){if(null===a){var b=navigator.userAgent.toLowerCase();a=-1!=b.indexOf("safari")?b.indexOf("chrome")>-1?!1:!0:!1}return a}}()};a.Sample=e}(window);